---
title: "Analysis Comparative Genomic Analysis of Endometriosis-Associated vs Non-Associated "
format: html
---

# Analysis 3 - Comparative Genomic Analysis of Endometriosis-Associated vs Non-Associated MAGs

In this analysis, we compare basic genomic features of MAGs from genera previously linked to endometriosis against all other vaginal MAGs. We focus on GC content, genome length, and assembly quality (completeness and contamination) to assess whether endometriosis-associated genera form a genomically distinct subgroup.

## Load libraries

```{r}
#| message: false
#| warning: false
library("tidyverse")
```

## Load data

```{r}
genome_metadata_aug <- readr::read_tsv("../data/03_dat_aug.tsv")
```

## 2. GC content of endometriosis-associated genera

We first compare the GC-content distributions between MAGs belonging to endometriosis-associated genera and those not linked to endometriosis. GC content can reflect long-term evolutionary pressures, so any systematic shift between the two groups could indicate deeper genomic differences.

```{r}
genome_metadata_aug |>
  ggplot(aes(x    = endometriosis_associated,
             y    = GC_content,
             fill = endometriosis_associated)) +
  geom_violin(trim = FALSE, alpha = 0.5) +
  geom_boxplot(width = 0.18,
               outlier.size = 0.7,
               alpha = 0.9,
               colour = "black") +
  scale_fill_brewer(palette = "Set2") +
  labs(
    x = "Endometriosis-associated genus",
    y = "GC content (%)",
    title = "GC content distributions by endometriosis association"
  ) +
  theme_minimal(base_size = 13) +
  theme(legend.position = "none")

```

The distributions show substantial overlap between the groups. Endometriosis-associated MAGs have a slightly lower median GC content, but the difference is modest and the overall ranges are similar. This indicates that GC composition does not clearly distinguish taxa associated with endometriosis.

## 3. Genome length comparison

Next, we test whether genome size relates differently to GC content in endometriosis-associated genera. If differences existed in evolutionary strategies—such as genome reduction or expansion—they might appear as distinct clustering patterns.

```{r}
genome_metadata_aug |>
  ggplot(aes(x      = GC_content,
             y      = Length,
             colour = endometriosis_associated)) +
  geom_point(alpha = 0.6, size = 2) +
  scale_y_log10() +
  scale_colour_brewer(palette = "Set1") +
  labs(
    x = "GC content (%)",
    y = "Genome length (bp, log scale)",
    title = "GC content vs genome length by endometriosis association",
    colour = "Associated"
  ) +
  theme_minimal(base_size = 13)


```

The scatterplot shows that MAGs from both groups occupy similar GC–length space. No association-specific cluster is visible, and both groups span comparable genome sizes across the GC spectrum. This suggests that genome size and GC composition are not meaningfully structured by endometriosis association.

## 4. Completeness and contamination

Finally, we investigate whether endometriosis-associated genera differ in technical assembly quality. Completeness and contamination reflect how well each genome was reconstructed and whether its quality differs systematically across groups.

```{r}

genome_metadata_aug |>
  select(endometriosis_associated,
         Completeness,
         Contamination) |>
  pivot_longer(
    cols      = c(Completeness, Contamination),
    names_to  = "metric",
    values_to = "value"
  ) |>
  ggplot(aes(x    = endometriosis_associated,
             y    = value,
             fill = endometriosis_associated)) +
  geom_violin(trim = FALSE, alpha = 0.5) +
  geom_boxplot(width = 0.17, outlier.size = 0.7, alpha = 0.9) +
  facet_wrap(~ metric, scales = "free_y") +
  scale_fill_brewer(palette = "Set2") +
  labs(
    x = "Endometriosis-associated genus",
    y = "Value (%)",
    title = "MAG completeness and contamination by association status"
  ) +
  theme_minimal(base_size = 13) +
  theme(legend.position = "none")


```

Both completeness and contamination distributions are nearly identical between associated and non-associated genera. Completeness remains high (\>90%) in both groups, and contamination is consistently low. This confirms that assembly quality is comparable across MAGs and does not bias downstream comparisons between the groups.

Using genera previously linked to endometriosis in vaginal microbiome studies, we annotated a subset of MAGs and compared their genomic features to the rest of the dataset. Across GC content, genome size, completeness, and contamination, the two groups showed only minor differences with broad overlap. This indicates that endometriosis-associated genera do not form a genomically distinct group within the vaginal microbiome. Instead, their relevance to endometriosis likely reflects differences in abundance or community composition rather than major differences in genome architecture.

## **5. Conclusion**

The GC-content analysis shows that MAGs in the dataset follow well-known phylogenetic patterns, confirming biologically consistent taxonomic assignments. GC content is only weakly related to genome size and has no detectable effect on assembly completeness or contamination, indicating that MAG quality is stable across all GC levels. A small number of GC outliers were identified, but their frequency matches what is expected from phylum size, and most deviations are minor. Overall, GC content supports the reliability of the dataset and reveals no systematic issues in genome reconstruction.
