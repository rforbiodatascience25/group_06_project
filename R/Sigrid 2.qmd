---
title: "Sigrid 2"
format: html
---

# Analysis X

1)  Perrotta et al. 2020, "The Vaginal Microbiome as a Tool to Predict rASRM Stage of Disease in Endometriosis" (<https://pmc.ncbi.nlm.nih.gov/articles/PMC7539818/?fbclid=IwY2xjawORmWpleHRuA2FlbQIxMABicmlkETFCNE1ORGh5R2I5YnFON3hIc3J0YwZhcHBfaWQQMjIyMDM5MTc4ODIwMDg5MgABHudjra2Awb-P-2n_AX0jh0TL7QEB0GKUOySJCyv1Q4CSbPONZVzM8625g9ol_aem_YJVNc_QXBVb1QSZ846w_sg#notes2>)

2)  Endobiota Study 2019, "The endobiota study: comparison of vaginal, cervical and gut microbiota between women with stage 3/4 endometriosis and healthy controls" (<https://www.nature.com/articles/s41598-019-39700-6>)

Across these vaginal datasets, the most consistently reported endometriosis-associated genera are:

-   Anaerococcus

-   Gardnerella

-   Streptococcus

-   Escherichia/Shigella

-   Ureaplasma

-   Alloprevotella

## Load libraries

```{r}
#| message: false
#| warning: false
library("tidyverse")
```

## Load data

```{r}
genome_metadata_aug <- readr::read_tsv("../data/03_dat_aug.tsv")
```

## 1. Annotating MAGs with endometriosis-associated genera.

We add a new column to the MAG dataset that flags whether each MAG belongs to a genus repeatedly associated with endometriosis in the vaginal microbiome. Labeling True or False

-   Anaerococcus

-   Gardnerella

-   Streptococcus

-   Escherichia/Shigella

-   Ureaplasma

-   Alloprevotella

```{r}

endo_genera <- c(
  "Anaerococcus",
  "Gardnerella",
  "Streptococcus",
  "Escherichia",
  "Shigella",
  "Ureaplasma",
  "Alloprevotella" 
)


genome_metadata_aug <- genome_metadata_aug |>
  dplyr::mutate(
    endometriosis_associated = Genus %in% endo_genera
  )


genome_metadata_aug |>
  dplyr::count(endometriosis_associated)

```

```{r}
view(genome_metadata_aug)
```

## 2. GC content of endometriosis-associated genera

We compare GC content between associated and non-associated groups.

```{r}
genome_metadata_aug |>
  ggplot2::ggplot(aes(x = endometriosis_associated, y = GC_content)) +
  ggplot2::geom_boxplot() +
  ggplot2::labs(
    x = "Endometriosis-associated genus",
    y = "GC content (%)",
    title = "GC content of MAGs by endometriosis association"
  )

```

The GC-content distributions of endometriosis-associated and non-associated MAGs are largely overlapping, with only a small difference in median values. This indicates that GC content does not systematically distinguish genera linked to endometriosis from the rest of the vaginal microbiome. Overall, GC composition appears similar across both groups.

## 3. Genome length comparison

We examine whether MAGs associated with endometriosis differ in genome size.

```{r}
genome_metadata_aug |>
  ggplot2::ggplot(aes(x = endometriosis_associated, y = Length)) +
  ggplot2::geom_boxplot() +
  ggplot2::scale_y_log10() +
  ggplot2::labs(
    x = "Endometriosis-associated genus",
    y = "Genome length (bp, log scale)",
    title = "Genome length of MAGs by endometriosis association"
  )

```

MAGs from endometriosis-associated genera tend to have slightly larger genome sizes compared with other vaginal taxa, although the ranges of both groups overlap broadly. This suggests that genome size is not strongly structured by endometriosis association, but the associated genera may include species with somewhat more expansive genomes.

## 4. Completeness and contamination

We assess whether endometriosis-associated genera differ in assembly quality.

### 4.1 Completeness

```{r}

genome_metadata_aug |>
  ggplot2::ggplot(aes(x = endometriosis_associated, y = Completeness)) +
  ggplot2::geom_boxplot() +
  ggplot2::labs(
    x = "Endometriosis-associated genus",
    y = "Completeness (%)",
    title = "MAG completeness vs endometriosis association"
  )


```

Completeness values are high for both groups, with only minor variation. Endometriosis-associated MAGs show completeness levels similar to those of other genera, suggesting that their assemblies are of comparable quality.

### 4.2 Contamination

```{r}

genome_metadata_aug |>
  ggplot2::ggplot(aes(x = endometriosis_associated, y = Contamination)) +
  ggplot2::geom_boxplot() +
  ggplot2::labs(
    x = "Endometriosis-associated genus",
    y = "Contamination (%)",
    title = "MAG contamination vs endometriosis association"
  )
```

Contamination levels are consistently low across both groups, with no clear differences between endometriosis-associated and non-associated MAGs. This indicates that assembly quality is comparable, and any genomic differences observed are unlikely to be driven by differences in contamination.

Using genera previously linked to endometriosis in vaginal microbiome studies, we annotated a subset of MAGs and compared their genomic features to the rest of the dataset. Across GC content, genome size, completeness, and contamination, the two groups showed only minor differences with broad overlap. This indicates that endometriosis-associated genera do not form a genomically distinct group within the vaginal microbiome. Instead, their relevance to endometriosis likely reflects differences in abundance or community composition rather than major differences in genome architecture.
