{
  "hash": "a682a6f279f7a6dea9cd212cf4beb9fe",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Analysis Comparative Genomic Analysis of Endometriosis-Associated vs Non-Associated \"\nformat: html\n---\n\n\n\n# Analysis 3 - Comparative Genomic Analysis of Endometriosis-Associated vs Non-Associated MAGs\n\nIn this analysis, we compare basic genomic features of MAGs from genera previously linked to endometriosis against all other vaginal MAGs. We focus on GC content, genome length, and assembly quality (completeness and contamination) to assess whether endometriosis-associated genera form a genomically distinct subgroup.\n\nAre endometriosis-associated MAGs genomically distinct?\n\n## 1. Load libraries\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"tidyverse\")\n```\n:::\n\n\n\n## 2. Load data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngenome_metadata_aug <- readr::read_tsv(\"../data/03_dat_aug.tsv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 618 Columns: 25\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \"\\t\"\nchr (15): Genome, Genome_type, Country, Continent, Domain, Phylum, Class, Or...\ndbl (10): Length, N_contigs, N50, GC_content, Completeness, Contamination, r...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n\n## 3. Phylum-level distribution of associated vs non-associated MAGs\n\nBefore comparing genomic features between endometriosis-associated and non-associated MAGs, it is important to understand whether the two groups are taxonomically comparable. GC content, genome size, and other genomic traits are strongly influenced by phylogeny, especially at the phylum level. If associated MAGs occur primarily within a few dominant phyla, any genomic differences reflect underlying phylogenetic structure rather than the biological effect of endometriosis association. A phylum-level analysis therefore provides essential context for interpreting all downstream genomic comparisons.\n\n### 3.1 Distribution of MAGs by phylum and association status\n\nThe plot shows how many MAGs occur in each phylum and whether the two groups (associated vs non-associated) are taxonomically balanced.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nphylum_prop_plot <-\n  genome_metadata_aug |>\n    count(Phylum, endometriosis_associated) |>\n    group_by(Phylum) |>\n    mutate(prop = n / sum(n)) |>\n    ggplot(aes(x = Phylum,\n               y = prop,\n               fill = endometriosis_associated)) +\n    geom_col() +\n    scale_fill_brewer(palette = \"Set1\") +\n    labs(\n      title = \"Proportion of endometriosis-\\nassociated MAGs by phylum\",\n      x     = \"Phylum\",\n      y     = \"Proportion\",\n      fill  = \"Associated\"\n    ) +\n    theme_minimal(base_size = 9) +\n    theme(\n      plot.title      = element_text(size = 11, face = \"bold\", hjust = 0.5),\n      axis.title.x    = element_text(size = 10, margin = margin(t = 6)),\n      axis.title.y    = element_text(size = 10, margin = margin(r = 6)),\n      axis.text.x     = element_text(size = 8, angle = 45, hjust = 1),\n      axis.text.y     = element_text(size = 8),\n      legend.title    = element_text(size = 9),\n      legend.text     = element_text(size = 8),\n\n      plot.margin      = margin(t = 20, r = 12, b = 10, l = 10),\n      panel.background = element_rect(fill = \"white\", colour = NA),\n      plot.background  = element_rect(fill = \"white\", colour = NA)\n    )\n\nggsave(\n  filename = \"../results/07_key_plot_1.png\",\n  plot     = phylum_prop_plot,\n  width    = 120,\n  height   = 90,\n  units    = \"mm\",\n  dpi      = 300\n)\n```\n:::\n\n\n\nSeveral phyla contain both “Yes” and “No” MAGs because endometriosis association is defined at the genus level, not the phylum level. Large vaginal phyla such as *Actinomycetota*, *Bacillota* and *Bacteroidota* include many different genera. As a result, these dominant phyla contain mostly non-associated MAGs, along with a smaller number of associated ones. This pattern is expected and reflects the natural structure of the vaginal microbiome rather than a phylum-wide association with the disease.\n\n### 3.2 Test for taxonomic enrichment\n\nWe next test whether the distribution of associated vs non-associated MAGs across phyla differs from what would be expected by chance.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nphylum_table <- table(\n  genome_metadata_aug$Phylum,\n  genome_metadata_aug$endometriosis_associated\n)\n\nphylum_table\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  \n                    No Yes\n  Actinomycetota   182  30\n  Bacillota        207  46\n  Bacteroidota      97   0\n  Campylobacterota   6   0\n  Fusobacteriota    14   0\n  Patescibacteria   14   0\n  Pseudomonadota    19   0\n  Synergistota       3   0\n```\n\n\n:::\n\n```{.r .cell-code}\nchisq.test(phylum_table)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in chisq.test(phylum_table): Chi-squared approximation may be incorrect\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  phylum_table\nX-squared = 30.251, df = 7, p-value = 8.542e-05\n```\n\n\n:::\n:::\n\n\n\nThe chi-square test shows a significant deviation from independence (p ≈ 8.5 × 10⁻⁵), meaning that the distribution of associated vs non-associated MAGs is not random across phyla. This result is fully expected, because only a few genera within *Actinomycetota* and *Bacillota* are annotated as endometriosis-associated, while other phyla contain no associated genera at all. The warning about the approximation occurs because several phyla contain very small counts (zeros), which is normal in microbiome datasets and does not change the biological interpretation.\n\n### 3.3 GC content within phyla\n\nTo check whether GC differences between associated and non-associated MAGs are influenced by phylum-level structure, we compare GC content within each phylum.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngc_violin_plot <-\n  genome_metadata_aug |>\n    ggplot(aes(x = endometriosis_associated,\n               y = GC_content,\n               fill = endometriosis_associated)) +\n    geom_violin(trim = FALSE, alpha = 0.5) +\n    geom_boxplot(width = 0.18,\n                 outlier.size = 0.7,\n                 alpha = 0.9,\n                 colour = \"black\") +\n    scale_fill_brewer(palette = \"Set2\") +\n    labs(\n      title = \"GC content distributions by endometriosis association\",\n      x     = \"Endometriosis-associated genus\",\n      y     = \"GC content (%)\"\n    ) +\n    theme_minimal(base_size = 10) +\n    theme(\n      plot.title      = element_text(size = 10, face = \"bold\", hjust = 0.5),\n      axis.title.x    = element_text(size = 12, margin = margin(t = 8)),\n      axis.title.y    = element_text(size = 12, margin = margin(r = 8)),\n      axis.text.x     = element_text(size = 10),\n      axis.text.y     = element_text(size = 10),\n      legend.position = \"none\",\n\n      panel.background = element_rect(fill = \"white\", colour = NA),\n      plot.background  = element_rect(fill = \"white\", colour = NA)\n    )\n\nggsave(\n  filename = \"../results/07_key_plot_2.png\",\n  plot     = gc_violin_plot,\n  width    = 120,\n  height   = 90,\n  units    = \"mm\",\n  dpi      = 300\n)\n```\n:::\n\n\n\nThe distributions show substantial overlap between the groups. Endometriosis-associated MAGs have a slightly lower median GC content, but the difference is modest and the overall ranges are similar. This indicates that GC composition does not clearly distinguish taxa associated with endometriosis. GC-content distributions are nearly identical, indicating no genomic differences between endometriosis-associated and non-associated MAGs.\n\nTogether, these results indicate that endometriosis-associated MAGs are a taxonomically restricted subset of the broader vaginal microbiome, and their genomic features are typical for their phyla. There is no evidence that endometriosis-associated genera form a genomically distinct lineage when accounting for taxonomy.\n\n## 4. Genome length comparison\n\nNext, we test whether genome size relates differently to GC content in endometriosis-associated genera. If differences existed in evolutionary strategies—such as genome reduction or expansion—they might appear as distinct clustering patterns.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngenome_metadata_aug |>\n  ggplot(aes(x      = GC_content,\n             y      = Length,\n             colour = endometriosis_associated)) +\n  geom_point(alpha = 0.6,\n             size  = 2) +\n  scale_y_log10() +\n  scale_colour_brewer(palette = \"Set1\") +\n  labs(\n    x      = \"GC content (%)\",\n    y      = \"Genome length (bp, log scale)\",\n    title  = \"GC content vs genome length by endometriosis association\",\n    colour = \"Associated\"\n  ) +\n  theme_minimal(base_size = 13)\n```\n\n::: {.cell-output-display}\n![](07_analysis_3_files/figure-html/unnamed-chunk-6-1.svg){width=672}\n:::\n:::\n\n\n\nThe scatterplot shows that MAGs from both groups occupy similar GC–length space. No association-specific cluster is visible, and both groups span comparable genome sizes across the GC spectrum. This suggests that genome size and GC composition are not meaningfully structured by endometriosis association.\n\n## 5. Completeness and contamination\n\nFinally, we investigate whether endometriosis-associated genera differ in technical assembly quality. Completeness and contamination reflect how well each genome was reconstructed and whether its quality differs systematically across groups.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngenome_metadata_aug |>\n  select(endometriosis_associated,\n         Completeness,\n         Contamination) |>\n  pivot_longer(\n    cols      = c(Completeness, Contamination),\n    names_to  = \"metric\",\n    values_to = \"value\"\n  ) |>\n  ggplot(aes(x    = endometriosis_associated,\n             y    = value,\n             fill = endometriosis_associated)) +\n  geom_violin(trim  = FALSE,\n              alpha = 0.5) +\n  geom_boxplot(width        = 0.17,\n               outlier.size = 0.7,\n               alpha        = 0.9) +\n  facet_wrap(~ metric,\n             scales = \"free_y\") +\n  scale_fill_brewer(palette = \"Set2\") +\n  labs(\n    x     = \"Endometriosis-associated genus\",\n    y     = \"Value (%)\",\n    title = \"MAG completeness and contamination by association status\"\n  ) +\n  theme_minimal(base_size = 13) +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](07_analysis_3_files/figure-html/unnamed-chunk-7-1.svg){width=672}\n:::\n:::\n\n\n\nBoth completeness and contamination distributions are nearly identical between associated and non-associated genera. Completeness remains high (\\>90%) in both groups, and contamination is consistently low. This confirms that assembly quality is comparable across MAGs and does not bias downstream comparisons between the groups.\n\nUsing genera previously linked to endometriosis in vaginal microbiome studies, we annotated a subset of MAGs and compared their genomic features to the rest of the dataset. Across GC content, genome size, completeness, and contamination, the two groups showed only minor differences with broad overlap. This indicates that endometriosis-associated genera do not form a genomically distinct group within the vaginal microbiome. Instead, their relevance to endometriosis likely reflects differences in abundance or community composition rather than major differences in genome architecture.\n\n## **6. Conclusion**\n\nThis analysis describes a comparative genomic evaluation showing that taxa associated with endometriosis are not genetically unique but simply part of expected vaginal microbial diversity, and their association with the disease likely arises from ecological, not genomic, differences.\n",
    "supporting": [
      "07_analysis_3_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}