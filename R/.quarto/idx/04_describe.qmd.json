{"title":"Description of data","markdown":{"yaml":{"title":"Description of data","format":"html"},"headingText":"Describe Data","containsRefs":false,"markdown":"\n\n\n## 1. Load libraries\n\n```{r}\n#| message: false\n#| warning: false\nlibrary(\"tidyverse\")\n```\n\n## 2. Load data\n\nLoading the data saved in the 03_dat_aug.tsv file\n\n```{r}\n#| echo: false\n#| eval: true\ngenome_metadata_aug <- readr::read_tsv(\"../data/03_dat_aug.tsv\")\n```\n\n## 3. Data overview\n\n### 3.1 Structure of the dataset\n\nUsing the `str` command to investigate, what the data looks like:\n\n```{r}\ndplyr::glimpse(genome_metadata_aug)\n```\n\nThe dataset contains 618 metagenome-assembled genomes (MAGs) and 25 variables. These span assembly statistics, taxonomic annotation, genomic features, geographical metadata, derived quality metrics and stated is endometriosis associated or not. Inspecting the structure helps confirm that the dataset is tidy (each variable is a column, each observation is a row).\n\n### 3.2 Missing values in key variables\n\nA key step in data description is identifying missing values. Here we summarize how many missing entries each variable contains.\n\n```{r}\ngenome_metadata_aug |>\n  dplyr::summarise(dplyr::across(dplyr::everything(), ~ sum(is.na(.x)))) |>\n  tidyr::pivot_longer(\n    cols      = dplyr::everything(),\n    names_to  = \"variable\",\n    values_to = \"n_missing\"\n  ) |>\n  dplyr::arrange(dplyr::desc(n_missing)) |>\n  dplyr::slice_head(n = 6)\n```\n\nMissing data is concentrated in four variables: Species, Country, Continent, and Genus. Species-level taxonomy is often unavailable for MAGs, explaining the high degree of missingness. Geographical metadata is also sparse in many public datasets, reflecting inconsistent reporting in the source studies. All other variables, including assembly metrics and higher taxonomic ranks, are fully complete.\n\n## 4. Taxonomic composition\n\nUnderstanding taxonomic composition helps describe the microbial diversity represented in the MAG catalogue. We summarize the number of genomes assigned to each phylum and visualise their distribution.\n\n### 4.1 Phylum counts\n\nCounting the different Phylums in the dataset\n\n```{r}\ngenome_metadata_aug |>\n  dplyr::count(Phylum, sort = TRUE)\n```\n\n### 4.2 Barplot of phyla\n\nPlotting the different Phylums in the dataset\n\n```{r}\nplot_phylum <-\n  genome_metadata_aug |>\n    dplyr::mutate(Phylum = stringr::str_trim(as.character(Phylum))) |>\n    dplyr::filter(!is.na(Phylum)) |>\n    dplyr::count(Phylum, sort = TRUE) |>\n    \n    ggplot2::ggplot(ggplot2::aes(\n      x = forcats::fct_reorder(Phylum, n), \n      y = n,\n      fill = Phylum)) +\n    ggplot2::geom_col() +\n    ggplot2::coord_flip() +\n    ggplot2::labs(\n      x = \"Phylum\",\n      y = \"Number of genomes\",\n      title = \"Number of genomes per phylum\"\n    ) +\n    ggplot2::theme_minimal(base_size = 11) +\n    ggplot2::theme(\n      plot.background  = element_rect(fill = \"white\", colour = NA),\n      panel.background = element_rect(fill = \"white\", colour = NA),\n      legend.position = \"none\"\n    )\n\nplot_phylum\n```\n\n```{r}\n#| echo: false\n#| eval: false\nggplot2::ggsave(\n  \"../results/04_key_plot_1.png\",\n  plot = plot_phylum,\n  width = 120,\n  height = 90,\n  units = \"mm\",\n  dpi = 300\n)\n```\n\nThe most represented phyla reflect the typical composition of the human vaginal microbiome (Bacillota, Actinobacteriota). Less common phyla such as Patescibacteria appear at lower frequencies and may represent niche taxa or poorly sampled lineages.\\\n\n## 6. MAG quality\n\nIn metagenomics, the reliability of a reconstructed genome depends on two key metrics: completeness (how much of the genome is recovered) and contamination (how much foreign DNA is incorrectly included). To facilitate interpretation, we also use categorical quality variables derived from these continuous measures: Completeness_quality, Contamination_quality, and Overall_quality. Together, these metrics provide an overview of the assembly reliability and the overall quality of the MAG catalogue.\n\n### 6.1 Distribution of completeness\n\nWe first examine the distribution of completeness values across all MAGs. Completeness estimates the proportion of the genome recovered during assembly, with higher values indicating more complete and reliable genomes.\n\n```{r}\nplot_completeness <- genome_metadata_aug |>\n  ggplot2::ggplot(ggplot2::aes(x = Completeness)) +\n  ggplot2::geom_density(\n    fill = \"#4C72B0\",\n    color = \"white\",\n    alpha = 0.6) +\n  ggplot2::labs(\n    x = \"Completeness (%)\",\n    y = \"Number of genomes\",\n    title = \"Density of genome completeness\"\n  )\n\nplot_completeness\n```\n\n```{r}\n#| echo: false\n#| eval: false\nggplot2::ggsave(\n  \"../results/04_key_plot_2.png\",\n  plot = plot_completeness,\n  width = 120,\n  height = 90,\n  units = \"mm\",\n  dpi = 300\n)\n```\n\nThe distribution shows that genome completeness is generally high, with many MAGs exceeding 80–90%. This suggests that the majority of genomes in the dataset are sufficiently complete for downstream biological analyses.\n\n### 6.2 Distribution of contamination\n\nNext, we assess contamination levels, which reflect how much non-target DNA is mistakenly included in each MAG. Low contamination is essential for ensuring that each genome represents a single biological organism.\n\n```{r}\ngenome_metadata_aug |>\n  ggplot2::ggplot(ggplot2::aes(x = Contamination)) +\n  ggplot2::geom_density(\n    fill = \"#4C72B0\",\n    color = \"white\",\n    alpha = 0.6) +\n  ggplot2::labs(\n    x = \"Contamination (%)\",\n    y = \"Number of genomes\",\n    title = \"Density of genome completeness\"\n  )\n```\n\nContamination values are generally very low, with most MAGs showing contamination close to 0%.\\\nThis indicates strong assembly quality and suggests that the majority of genomes fall within accepted thresholds for medium to high MAG quality.\n\n### 6.3 Completeness-based quality categories\n\nTo simplify interpretation, completeness values are grouped into categorical quality assignments (e.g., high, medium, low).\\\n\nThese categories help summarize the distribution of assembly completeness across the dataset.\n\n```{r}\ngenome_metadata_aug |>\n  dplyr::count(Completeness_quality)\n```\n\nWe visualize the distribution of completeness categories to assess the overall completeness profile of the dataset.\n\n```{r}\ngenome_metadata_aug |>\n  dplyr::count(Completeness_quality) |>\n  ggplot2::ggplot(ggplot2::aes(\n    x = Completeness_quality,\n    y = n,\n    fill = Completeness_quality)) +\n  ggplot2::geom_col() +\n  ggplot2::scale_fill_manual(\n    values = c(\n      \"High\"   = \"#4C72B0\",  # blue\n      \"Medium\" = \"#d62728\",  # red\n      \"Low\"    = \"#2ca02c\"   # green\n    )\n  ) +\n  ggplot2::labs(\n    x     = \"Completeness quality category\",\n    y     = \"Number of genomes\",\n    title = \"MAGs by completeness quality\"\n  ) +\n  ggplot2::theme_minimal(base_size = 13)\n```\n\nMost genomes fall into the medium and high completeness categories, confirming the generally strong completeness characteristics observed in the continuous distribution.\n\n### 6.4 Contamination-based quality categories\n\nSimilar to completeness, contamination values are grouped into quality categories. This provides a simplified overview of how many MAGs fall above or below contamination thresholds commonly used in MAG quality standards.\n\n```{r}\ngenome_metadata_aug |>\n  dplyr::count(Contamination_quality)\n```\n\nAll the genomes fall into the *high* contamination-quality category (very low contamination), reinforcing the observation that contamination levels are generally well-controlled in this dataset.\n\nWe visualize the distribution of contamination categories to assess the overall completeness profile of the dataset.\n\n```{r}\ngenome_metadata_aug |>\n  dplyr::count(Contamination_quality) |>\n ggplot2:: ggplot(ggplot2::aes(\n   x = Contamination_quality,\n   y = n,\n   fill = Contamination_quality)) +\n  ggplot2::geom_col() +\n  ggplot2::scale_fill_manual(\n    values = c(\n      \"High\"   = \"#4C72B0\",   \n      \"Medium\" = \"#d62728\",   \n      \"Low\"    = \"#2ca02c\"    \n    )\n  ) +\n  ggplot2::labs(\n    x     = \"Contamination quality category\",\n    y     = \"Number of genomes\",\n    title = \"MAGs by contamination quality\"\n  ) +\n  ggplot2::theme_minimal(base_size = 13)\n```\n\n### 6.5 Overall MAG quality category\n\nThe overall quality category combines both completeness and contamination thresholds into a single metric. This provides the most useful summary when determining which genomes are suitable for specific downstream analyses.\n\n```{r}\ngenome_metadata_aug |>\n  dplyr::count(Overall_quality)\n```\n\nWe visualize the number of genomes in each overall quality category.\n\n```{r}\ngenome_metadata_aug |>\n  dplyr::count(Overall_quality) |>\n  ggplot2::ggplot(ggplot2::aes(\n    x = Overall_quality,\n    y = n,\n    fill = Overall_quality)) +\n  ggplot2::geom_col() +\n  ggplot2::scale_fill_manual(\n    values = c(\n      \"High\"   = \"#4C72B0\",   \n      \"Medium\" = \"#d62728\",   \n      \"Low\"    = \"#2ca02c\"    \n    )) +\n  ggplot2::labs(\n    x     = \"Overall MAG quality\",\n    y     = \"Number of genomes\",\n    title = \"Overall MAG quality categories\"\n  )\n```\n\nMost genomes fall into the medium and high overall quality categories, while only a small number are classified as low quality. This confirms that the dataset contains predominantly reliable MAGs that are suitable for biological interpretation. These quality categories can later be used to filter or stratify analyses depending on the research question.\n\n## 7 Assembly statistics\n\nAssembly statistics provide insight into the structural properties of metagenome-assembled genomes (MAGs). Characteristics such as genome length and contig count reflect the degree of completeness and fragmentation of each assembly, and they help assess whether the reconstructed genomes are biologically plausible and suitable for further interpretation.\n\nHere, we explore three key aspects: genome size, contig count, and the relationship between genome length and fragmentation.\n\n### 7.1 Genome length distribution\n\nGenome length is a basic but informative assembly metric. It varies across bacterial taxa due to differences in genome reduction, metabolic capabilities, ecological specialization, and evolutionary history. Examining the distribution of genome lengths allows us to understand the range of genome sizes represented in the dataset and identify unusual or outlier assemblies.\n\n```{r}\nplot_length <- genome_metadata_aug |>\n  ggplot2::ggplot(ggplot2::aes(x = Length)) +\n  ggplot2::geom_density(\n    fill = \"#4C72B0\",\n    color = \"white\",\n    alpha = 0.6) +\n  ggplot2::labs(\n    x = \"Genome length (bp)\",\n    y = \"Number of genomes\",\n    title = \"Density of genome completeness\"\n  )\n\nplot_length\n```\n\n```{r}\n#| echo: false\n#| eval: false\nggplot2::ggsave(\n  \"../results/04_key_plot_3.png\",\n  plot = plot_length,\n  width = 120,\n  height = 90,\n  units = \"mm\",\n  dpi = 300\n)\n```\n\nGenome sizes range from roughly 0.6 Mbp to more than 3 Mbp, which is typical for bacterial taxa found in the vaginal microbiome. Smaller genomes often reflect host-adapted or metabolically reduced bacteria, whereas larger genomes may indicate more metabolically versatile organisms. The observed range therefore aligns with expectations for vaginal microbial diversity and suggests no major abnormalities in genome size distributions.\n\n### 7.2 Number of contigs\n\nThe number of contigs in a MAG reflects how fragmented the assembly is. A low number of contigs indicates a more complete, contiguous assembly, while higher contig counts indicate fragmentation, often reflecting assembly challenges such as low coverage, strain heterogeneity, or complex genomic regions.\n\n```{r}\ngenome_metadata_aug |>\n  ggplot2::ggplot(ggplot2::aes(x = N_contigs)) +\n  ggplot2::geom_histogram(\n    bins  = 30,\n    fill  = \"#4C72B0\",\n    color = \"white\"\n  ) +\n  ggplot2::labs(\n    x     = \"Number of contigs\",\n    y     = \"Number of genomes\",\n    title = \"Distribution of contig counts\"\n  )\n```\n\nThe distribution shows substantial variation in contig counts across MAGs. While some genomes are assembled into relatively few contigs, others remain highly fragmented - a common characteristic of metagenomic assemblies. This variation highlights the importance of considering assembly fragmentation when interpreting genome structure and gene content.\n\n### 7.3 Length vs number of contigs\n\nTo further understand assembly quality, we explore the relationship between genome length and assembly fragmentation. Longer genomes may naturally require more contigs, but excessively high fragmentation for a given genome size may indicate problematic or low-confidence assemblies.\n\n```{r}\ngenome_metadata_aug |>\n  ggplot2::ggplot(ggplot2::aes(\n    x = Length,\n    y = N_contigs)) +\n  ggplot2::geom_point(\n    alpha = 0.5,\n    colour = \"#4C72B0\") +\n  ggplot2::labs(\n    x     = \"Genome length (bp)\",\n    y     = \"Number of contigs\",\n    title = \"Genome length vs fragmentation\"\n  )\n```\n\nThe scatterplot shows a loose association between genome length and the number of contigs, as expected. However, several outliers exhibit unusually high fragmentation relative to their genome size, which may indicate assembly challenges.\n\n## 8. GC content\n\nGC content represents the proportion of guanine (G) and cytosine (C) bases in a genome. It is an important genomic characteristic linked to evolutionary lineage, genome stability, mutational patterns, host adaptation, and environmental niche.\n\nExamining the GC content distribution across the MAG catalogue provides insight into the diversity of bacterial taxa present in the vaginal microbiome and can help identify unusual or atypical genomes.\n\n### 8.1 GC content distribution\n\nWe begin by visualizing the distribution of GC content across all genomes. MAGs originating from different bacterial phyla typically exhibit distinct GC signatures, making this metric useful for broadly comparing genome characteristics across the dataset.\n\n```{r}\ngenome_metadata_aug |>\n  ggplot2::ggplot(ggplot2::aes(x = GC_content)) +\n  ggplot2::geom_histogram(\n    bins  = 30,\n    fill  = \"#4C72B0\",\n    color = \"white\"\n  ) +\n  ggplot2::labs(\n    x     = \"GC content (%)\",\n    y     = \"Number of genomes\",\n    title = \"Distribution of GC content\"\n  )\n```\n\nGC content across the genomes spans a broad range-from approximately 25% up to more than 70%, indicating substantial genomic diversity within the vaginal microbiome. Most genomes cluster in the intermediate GC range (35–50%), which is typical for many common vaginal taxa, including Lactobacillus, Gardnerella, and Prevotella.\n\nThe presence of both low-GC and high-GC genomes reflects the contribution of multiple phylogenetic groups and suggests distinct evolutionary and ecological strategies among community members. Extreme GC values may point to highly specialized or unusual taxa and could be explored in later analyses.\n\n## 9. Geographic metadata\n\nGeographic metadata provides important ecological and epidemiological context for metagenomic studies. It can reveal where samples were collected, help identify potential biogeographic patterns, and highlight sampling gaps or biases in the dataset.\n\n### 9.1 Availability of geographic information\n\nWe first examine how many genomes include a recorded continent of origin. This allows us to quantify the completeness of the geographic metadata and determine how representative the dataset may be across global regions.\n\n```{r}\ngenome_metadata_aug |>\n  dplyr::mutate(has_geography = !is.na(Continent)) |>\n  dplyr::count(has_geography)\n```\n\nOnly a subset of genomes includes geographic information, indicating incomplete metadata coverage. This is common in public metagenomic datasets, where sample-associated metadata is often missing or inconsistently reported. The absence of geographic context for many genomes limits the extent to which biogeographical conclusions can be drawn.\n\n### 9.2 Genomes per country\n\nFor genomes where geographic information is available, we summarize the number of genomes contributed from each country\n\n```{r}\ngenome_metadata_aug |>\n  dplyr::count(Country, sort = TRUE)\n```\n\nWe visualize the distribution of genomes across continents to highlight sampling imbalances.\n\n```{r}\ngenome_metadata_aug |>\n  dplyr::count(Country) |>\n  ggplot2::ggplot(ggplot2::aes(\n    x = Country,\n    y = n)) +\n  ggplot2::geom_col(ggplot2::aes(fill = Country)) +\n  ggplot2::labs(\n    x     = \"Country\",\n    y     = \"Number of genomes\",\n    title = \"Number of genomes per country\"\n  )\n```\n\nThe geographic distribution of genomes is uneven, with certain countries (USA and china) contributing the majority of available data. This reflects sampling bias, where research efforts and sequencing initiatives are concentrated in specific regions.\n\n## 10. Descriptive summary\n\nOverall, the dataset contains 618 vaginal MAGs with high completeness, low contamination, and diverse taxonomic representation. Genome features such as size and GC content fall within biologically plausible ranges. Missing values are limited primarily to species-level taxonomy and geographical metadata. The dataset is therefore well-suited for downstream comparative analyses, including quality assessment across taxa, genome feature correlations, and ecological interpretation.\n","srcMarkdownNoYaml":"\n\n# Describe Data\n\n## 1. Load libraries\n\n```{r}\n#| message: false\n#| warning: false\nlibrary(\"tidyverse\")\n```\n\n## 2. Load data\n\nLoading the data saved in the 03_dat_aug.tsv file\n\n```{r}\n#| echo: false\n#| eval: true\ngenome_metadata_aug <- readr::read_tsv(\"../data/03_dat_aug.tsv\")\n```\n\n## 3. Data overview\n\n### 3.1 Structure of the dataset\n\nUsing the `str` command to investigate, what the data looks like:\n\n```{r}\ndplyr::glimpse(genome_metadata_aug)\n```\n\nThe dataset contains 618 metagenome-assembled genomes (MAGs) and 25 variables. These span assembly statistics, taxonomic annotation, genomic features, geographical metadata, derived quality metrics and stated is endometriosis associated or not. Inspecting the structure helps confirm that the dataset is tidy (each variable is a column, each observation is a row).\n\n### 3.2 Missing values in key variables\n\nA key step in data description is identifying missing values. Here we summarize how many missing entries each variable contains.\n\n```{r}\ngenome_metadata_aug |>\n  dplyr::summarise(dplyr::across(dplyr::everything(), ~ sum(is.na(.x)))) |>\n  tidyr::pivot_longer(\n    cols      = dplyr::everything(),\n    names_to  = \"variable\",\n    values_to = \"n_missing\"\n  ) |>\n  dplyr::arrange(dplyr::desc(n_missing)) |>\n  dplyr::slice_head(n = 6)\n```\n\nMissing data is concentrated in four variables: Species, Country, Continent, and Genus. Species-level taxonomy is often unavailable for MAGs, explaining the high degree of missingness. Geographical metadata is also sparse in many public datasets, reflecting inconsistent reporting in the source studies. All other variables, including assembly metrics and higher taxonomic ranks, are fully complete.\n\n## 4. Taxonomic composition\n\nUnderstanding taxonomic composition helps describe the microbial diversity represented in the MAG catalogue. We summarize the number of genomes assigned to each phylum and visualise their distribution.\n\n### 4.1 Phylum counts\n\nCounting the different Phylums in the dataset\n\n```{r}\ngenome_metadata_aug |>\n  dplyr::count(Phylum, sort = TRUE)\n```\n\n### 4.2 Barplot of phyla\n\nPlotting the different Phylums in the dataset\n\n```{r}\nplot_phylum <-\n  genome_metadata_aug |>\n    dplyr::mutate(Phylum = stringr::str_trim(as.character(Phylum))) |>\n    dplyr::filter(!is.na(Phylum)) |>\n    dplyr::count(Phylum, sort = TRUE) |>\n    \n    ggplot2::ggplot(ggplot2::aes(\n      x = forcats::fct_reorder(Phylum, n), \n      y = n,\n      fill = Phylum)) +\n    ggplot2::geom_col() +\n    ggplot2::coord_flip() +\n    ggplot2::labs(\n      x = \"Phylum\",\n      y = \"Number of genomes\",\n      title = \"Number of genomes per phylum\"\n    ) +\n    ggplot2::theme_minimal(base_size = 11) +\n    ggplot2::theme(\n      plot.background  = element_rect(fill = \"white\", colour = NA),\n      panel.background = element_rect(fill = \"white\", colour = NA),\n      legend.position = \"none\"\n    )\n\nplot_phylum\n```\n\n```{r}\n#| echo: false\n#| eval: false\nggplot2::ggsave(\n  \"../results/04_key_plot_1.png\",\n  plot = plot_phylum,\n  width = 120,\n  height = 90,\n  units = \"mm\",\n  dpi = 300\n)\n```\n\nThe most represented phyla reflect the typical composition of the human vaginal microbiome (Bacillota, Actinobacteriota). Less common phyla such as Patescibacteria appear at lower frequencies and may represent niche taxa or poorly sampled lineages.\\\n\n## 6. MAG quality\n\nIn metagenomics, the reliability of a reconstructed genome depends on two key metrics: completeness (how much of the genome is recovered) and contamination (how much foreign DNA is incorrectly included). To facilitate interpretation, we also use categorical quality variables derived from these continuous measures: Completeness_quality, Contamination_quality, and Overall_quality. Together, these metrics provide an overview of the assembly reliability and the overall quality of the MAG catalogue.\n\n### 6.1 Distribution of completeness\n\nWe first examine the distribution of completeness values across all MAGs. Completeness estimates the proportion of the genome recovered during assembly, with higher values indicating more complete and reliable genomes.\n\n```{r}\nplot_completeness <- genome_metadata_aug |>\n  ggplot2::ggplot(ggplot2::aes(x = Completeness)) +\n  ggplot2::geom_density(\n    fill = \"#4C72B0\",\n    color = \"white\",\n    alpha = 0.6) +\n  ggplot2::labs(\n    x = \"Completeness (%)\",\n    y = \"Number of genomes\",\n    title = \"Density of genome completeness\"\n  )\n\nplot_completeness\n```\n\n```{r}\n#| echo: false\n#| eval: false\nggplot2::ggsave(\n  \"../results/04_key_plot_2.png\",\n  plot = plot_completeness,\n  width = 120,\n  height = 90,\n  units = \"mm\",\n  dpi = 300\n)\n```\n\nThe distribution shows that genome completeness is generally high, with many MAGs exceeding 80–90%. This suggests that the majority of genomes in the dataset are sufficiently complete for downstream biological analyses.\n\n### 6.2 Distribution of contamination\n\nNext, we assess contamination levels, which reflect how much non-target DNA is mistakenly included in each MAG. Low contamination is essential for ensuring that each genome represents a single biological organism.\n\n```{r}\ngenome_metadata_aug |>\n  ggplot2::ggplot(ggplot2::aes(x = Contamination)) +\n  ggplot2::geom_density(\n    fill = \"#4C72B0\",\n    color = \"white\",\n    alpha = 0.6) +\n  ggplot2::labs(\n    x = \"Contamination (%)\",\n    y = \"Number of genomes\",\n    title = \"Density of genome completeness\"\n  )\n```\n\nContamination values are generally very low, with most MAGs showing contamination close to 0%.\\\nThis indicates strong assembly quality and suggests that the majority of genomes fall within accepted thresholds for medium to high MAG quality.\n\n### 6.3 Completeness-based quality categories\n\nTo simplify interpretation, completeness values are grouped into categorical quality assignments (e.g., high, medium, low).\\\n\nThese categories help summarize the distribution of assembly completeness across the dataset.\n\n```{r}\ngenome_metadata_aug |>\n  dplyr::count(Completeness_quality)\n```\n\nWe visualize the distribution of completeness categories to assess the overall completeness profile of the dataset.\n\n```{r}\ngenome_metadata_aug |>\n  dplyr::count(Completeness_quality) |>\n  ggplot2::ggplot(ggplot2::aes(\n    x = Completeness_quality,\n    y = n,\n    fill = Completeness_quality)) +\n  ggplot2::geom_col() +\n  ggplot2::scale_fill_manual(\n    values = c(\n      \"High\"   = \"#4C72B0\",  # blue\n      \"Medium\" = \"#d62728\",  # red\n      \"Low\"    = \"#2ca02c\"   # green\n    )\n  ) +\n  ggplot2::labs(\n    x     = \"Completeness quality category\",\n    y     = \"Number of genomes\",\n    title = \"MAGs by completeness quality\"\n  ) +\n  ggplot2::theme_minimal(base_size = 13)\n```\n\nMost genomes fall into the medium and high completeness categories, confirming the generally strong completeness characteristics observed in the continuous distribution.\n\n### 6.4 Contamination-based quality categories\n\nSimilar to completeness, contamination values are grouped into quality categories. This provides a simplified overview of how many MAGs fall above or below contamination thresholds commonly used in MAG quality standards.\n\n```{r}\ngenome_metadata_aug |>\n  dplyr::count(Contamination_quality)\n```\n\nAll the genomes fall into the *high* contamination-quality category (very low contamination), reinforcing the observation that contamination levels are generally well-controlled in this dataset.\n\nWe visualize the distribution of contamination categories to assess the overall completeness profile of the dataset.\n\n```{r}\ngenome_metadata_aug |>\n  dplyr::count(Contamination_quality) |>\n ggplot2:: ggplot(ggplot2::aes(\n   x = Contamination_quality,\n   y = n,\n   fill = Contamination_quality)) +\n  ggplot2::geom_col() +\n  ggplot2::scale_fill_manual(\n    values = c(\n      \"High\"   = \"#4C72B0\",   \n      \"Medium\" = \"#d62728\",   \n      \"Low\"    = \"#2ca02c\"    \n    )\n  ) +\n  ggplot2::labs(\n    x     = \"Contamination quality category\",\n    y     = \"Number of genomes\",\n    title = \"MAGs by contamination quality\"\n  ) +\n  ggplot2::theme_minimal(base_size = 13)\n```\n\n### 6.5 Overall MAG quality category\n\nThe overall quality category combines both completeness and contamination thresholds into a single metric. This provides the most useful summary when determining which genomes are suitable for specific downstream analyses.\n\n```{r}\ngenome_metadata_aug |>\n  dplyr::count(Overall_quality)\n```\n\nWe visualize the number of genomes in each overall quality category.\n\n```{r}\ngenome_metadata_aug |>\n  dplyr::count(Overall_quality) |>\n  ggplot2::ggplot(ggplot2::aes(\n    x = Overall_quality,\n    y = n,\n    fill = Overall_quality)) +\n  ggplot2::geom_col() +\n  ggplot2::scale_fill_manual(\n    values = c(\n      \"High\"   = \"#4C72B0\",   \n      \"Medium\" = \"#d62728\",   \n      \"Low\"    = \"#2ca02c\"    \n    )) +\n  ggplot2::labs(\n    x     = \"Overall MAG quality\",\n    y     = \"Number of genomes\",\n    title = \"Overall MAG quality categories\"\n  )\n```\n\nMost genomes fall into the medium and high overall quality categories, while only a small number are classified as low quality. This confirms that the dataset contains predominantly reliable MAGs that are suitable for biological interpretation. These quality categories can later be used to filter or stratify analyses depending on the research question.\n\n## 7 Assembly statistics\n\nAssembly statistics provide insight into the structural properties of metagenome-assembled genomes (MAGs). Characteristics such as genome length and contig count reflect the degree of completeness and fragmentation of each assembly, and they help assess whether the reconstructed genomes are biologically plausible and suitable for further interpretation.\n\nHere, we explore three key aspects: genome size, contig count, and the relationship between genome length and fragmentation.\n\n### 7.1 Genome length distribution\n\nGenome length is a basic but informative assembly metric. It varies across bacterial taxa due to differences in genome reduction, metabolic capabilities, ecological specialization, and evolutionary history. Examining the distribution of genome lengths allows us to understand the range of genome sizes represented in the dataset and identify unusual or outlier assemblies.\n\n```{r}\nplot_length <- genome_metadata_aug |>\n  ggplot2::ggplot(ggplot2::aes(x = Length)) +\n  ggplot2::geom_density(\n    fill = \"#4C72B0\",\n    color = \"white\",\n    alpha = 0.6) +\n  ggplot2::labs(\n    x = \"Genome length (bp)\",\n    y = \"Number of genomes\",\n    title = \"Density of genome completeness\"\n  )\n\nplot_length\n```\n\n```{r}\n#| echo: false\n#| eval: false\nggplot2::ggsave(\n  \"../results/04_key_plot_3.png\",\n  plot = plot_length,\n  width = 120,\n  height = 90,\n  units = \"mm\",\n  dpi = 300\n)\n```\n\nGenome sizes range from roughly 0.6 Mbp to more than 3 Mbp, which is typical for bacterial taxa found in the vaginal microbiome. Smaller genomes often reflect host-adapted or metabolically reduced bacteria, whereas larger genomes may indicate more metabolically versatile organisms. The observed range therefore aligns with expectations for vaginal microbial diversity and suggests no major abnormalities in genome size distributions.\n\n### 7.2 Number of contigs\n\nThe number of contigs in a MAG reflects how fragmented the assembly is. A low number of contigs indicates a more complete, contiguous assembly, while higher contig counts indicate fragmentation, often reflecting assembly challenges such as low coverage, strain heterogeneity, or complex genomic regions.\n\n```{r}\ngenome_metadata_aug |>\n  ggplot2::ggplot(ggplot2::aes(x = N_contigs)) +\n  ggplot2::geom_histogram(\n    bins  = 30,\n    fill  = \"#4C72B0\",\n    color = \"white\"\n  ) +\n  ggplot2::labs(\n    x     = \"Number of contigs\",\n    y     = \"Number of genomes\",\n    title = \"Distribution of contig counts\"\n  )\n```\n\nThe distribution shows substantial variation in contig counts across MAGs. While some genomes are assembled into relatively few contigs, others remain highly fragmented - a common characteristic of metagenomic assemblies. This variation highlights the importance of considering assembly fragmentation when interpreting genome structure and gene content.\n\n### 7.3 Length vs number of contigs\n\nTo further understand assembly quality, we explore the relationship between genome length and assembly fragmentation. Longer genomes may naturally require more contigs, but excessively high fragmentation for a given genome size may indicate problematic or low-confidence assemblies.\n\n```{r}\ngenome_metadata_aug |>\n  ggplot2::ggplot(ggplot2::aes(\n    x = Length,\n    y = N_contigs)) +\n  ggplot2::geom_point(\n    alpha = 0.5,\n    colour = \"#4C72B0\") +\n  ggplot2::labs(\n    x     = \"Genome length (bp)\",\n    y     = \"Number of contigs\",\n    title = \"Genome length vs fragmentation\"\n  )\n```\n\nThe scatterplot shows a loose association between genome length and the number of contigs, as expected. However, several outliers exhibit unusually high fragmentation relative to their genome size, which may indicate assembly challenges.\n\n## 8. GC content\n\nGC content represents the proportion of guanine (G) and cytosine (C) bases in a genome. It is an important genomic characteristic linked to evolutionary lineage, genome stability, mutational patterns, host adaptation, and environmental niche.\n\nExamining the GC content distribution across the MAG catalogue provides insight into the diversity of bacterial taxa present in the vaginal microbiome and can help identify unusual or atypical genomes.\n\n### 8.1 GC content distribution\n\nWe begin by visualizing the distribution of GC content across all genomes. MAGs originating from different bacterial phyla typically exhibit distinct GC signatures, making this metric useful for broadly comparing genome characteristics across the dataset.\n\n```{r}\ngenome_metadata_aug |>\n  ggplot2::ggplot(ggplot2::aes(x = GC_content)) +\n  ggplot2::geom_histogram(\n    bins  = 30,\n    fill  = \"#4C72B0\",\n    color = \"white\"\n  ) +\n  ggplot2::labs(\n    x     = \"GC content (%)\",\n    y     = \"Number of genomes\",\n    title = \"Distribution of GC content\"\n  )\n```\n\nGC content across the genomes spans a broad range-from approximately 25% up to more than 70%, indicating substantial genomic diversity within the vaginal microbiome. Most genomes cluster in the intermediate GC range (35–50%), which is typical for many common vaginal taxa, including Lactobacillus, Gardnerella, and Prevotella.\n\nThe presence of both low-GC and high-GC genomes reflects the contribution of multiple phylogenetic groups and suggests distinct evolutionary and ecological strategies among community members. Extreme GC values may point to highly specialized or unusual taxa and could be explored in later analyses.\n\n## 9. Geographic metadata\n\nGeographic metadata provides important ecological and epidemiological context for metagenomic studies. It can reveal where samples were collected, help identify potential biogeographic patterns, and highlight sampling gaps or biases in the dataset.\n\n### 9.1 Availability of geographic information\n\nWe first examine how many genomes include a recorded continent of origin. This allows us to quantify the completeness of the geographic metadata and determine how representative the dataset may be across global regions.\n\n```{r}\ngenome_metadata_aug |>\n  dplyr::mutate(has_geography = !is.na(Continent)) |>\n  dplyr::count(has_geography)\n```\n\nOnly a subset of genomes includes geographic information, indicating incomplete metadata coverage. This is common in public metagenomic datasets, where sample-associated metadata is often missing or inconsistently reported. The absence of geographic context for many genomes limits the extent to which biogeographical conclusions can be drawn.\n\n### 9.2 Genomes per country\n\nFor genomes where geographic information is available, we summarize the number of genomes contributed from each country\n\n```{r}\ngenome_metadata_aug |>\n  dplyr::count(Country, sort = TRUE)\n```\n\nWe visualize the distribution of genomes across continents to highlight sampling imbalances.\n\n```{r}\ngenome_metadata_aug |>\n  dplyr::count(Country) |>\n  ggplot2::ggplot(ggplot2::aes(\n    x = Country,\n    y = n)) +\n  ggplot2::geom_col(ggplot2::aes(fill = Country)) +\n  ggplot2::labs(\n    x     = \"Country\",\n    y     = \"Number of genomes\",\n    title = \"Number of genomes per country\"\n  )\n```\n\nThe geographic distribution of genomes is uneven, with certain countries (USA and china) contributing the majority of available data. This reflects sampling bias, where research efforts and sequencing initiatives are concentrated in specific regions.\n\n## 10. Descriptive summary\n\nOverall, the dataset contains 618 vaginal MAGs with high completeness, low contamination, and diverse taxonomic representation. Genome features such as size and GC content fall within biologically plausible ranges. Missing values are limited primarily to species-level taxonomy and geographical metadata. The dataset is therefore well-suited for downstream comparative analyses, including quality assessment across taxa, genome feature correlations, and ecological interpretation.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"0":"R/01_load.qmd","1":"R/02_clean.qmd","2":"R/03_augment.qmd","3":"R/04_describe.qmd","keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"04_describe.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","formats":{"html":{"embed-resources":false}},"title":"Description of data"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}