{"title":"Clean dataset","markdown":{"yaml":{"title":"Clean dataset","format":"html"},"headingText":"Clean Data","containsRefs":false,"markdown":"\n\n\n## 1. Load libraries\n\n```{r}\n#| message: false\n#| warning: false\nlibrary(\"tidyverse\")\n```\n\n## 2. Load data\n\nLoading the data saved in the 01_dat_load.tsv file\n\n```{r}\ngenome_metadata <- readr::read_tsv(\"../data/01_dat_load.tsv\")\n```\n\n## 3. Data preparation\n\nUsing the `str` command to investigate, what the data looks like:\n\n```{r}\nstr(genome_metadata)\n```\n\nThe data consist of a data-frame with 618 observations and 20 variables. We recognize that observations with no value found has the identifier \"not provided\". Additionally one variable contains phylogenetic information that can be split into different variable containing information about the different classes of the evolutionary history.\n\n### 3.1 Split data\n\nWe want to split the data in the \"lineage\" variable into multiple variables to store the information about each of the phylogenetic classes individually. First we investigate the data in the lineage variable:\n\n```{r}\ngenome_metadata |>\n  dplyr::select(Lineage) |>\n  dplyr::slice_sample(n = 10)\n```\n\nBy investigating the data it is seen that each string of phylogenetic information consist of identifiers for each of the different classes in the taxonomic rank. These identifiers are:\n\n-   d = domain\n\n-   p = phylum\n\n-   c = class\n\n-   o = order\n\n-   f = family\n\n-   g = genus\n\n-   s = species\n\nWe want to start with converting all \"not provided\" to NA across all character columns. Then we want to split the \"lineage\" variable into its seven taxonomic ranks to store the information about each of the phylogenetic classes individually. Then we want to extract each taxonomic rank and remove prefixes. And convert empty strings to NA in the new taxonomy columns.\n\nWe then remove the GTDB suffixes (e.g. \"\\_A\") to streamline taxonomies. Lastly we remove columns that will not be used in our analysis.\n\n```{r}\ngenome_metadata_clean <- genome_metadata |>\n  dplyr::mutate(\n    dplyr::across(\n      .cols = where(is.character),\n      .fns  = ~ dplyr::na_if(.x, \"not provided\")\n    )\n  ) |>\n  dplyr::mutate(\n    split_lineage = stringr::str_split_fixed(Lineage, \";\", 7),\n\n    Domain  = stringr::str_remove(split_lineage[, 1], \"d__\"),\n    Phylum  = stringr::str_remove(split_lineage[, 2], \"p__\"),\n    Class   = stringr::str_remove(split_lineage[, 3], \"c__\"),\n    Order   = stringr::str_remove(split_lineage[, 4], \"o__\"),\n    Family  = stringr::str_remove(split_lineage[, 5], \"f__\"),\n    Genus   = stringr::str_remove(split_lineage[, 6], \"g__\"),\n    Species = stringr::str_remove(split_lineage[, 7], \"s__\")\n  ) |>\n  dplyr::mutate(\n    dplyr::across(\n      .cols = c(Domain, Phylum, Class, Order, Family, Genus, Species),\n      .fns  = ~ dplyr::na_if(.x, \"\")\n    )\n  ) |>\n  dplyr::mutate(\n    dplyr::across(\n      .cols = Phylum:Species,\n      .fns  = ~ stringr::str_remove_all(as.character(.x), \"_[A-Za-z0-9]+\")\n    )\n  ) |>\n  dplyr::select(\n    -split_lineage,\n    -Genome_accession,\n    -Species_rep,\n    -Lineage,\n    -Sample_accession,\n    -Study_accession,\n    -FTP_download\n  )\n```\n\n### 3.2 Viewing the data\n\nViewing the top 10 rows of the split data to see the new structure.\n\n```{r}\ngenome_metadata_clean |> \n  dplyr::select(Genome, Domain:Species) |> \n  dplyr::slice_head(n = 10)\n```\n\n```{r}\nview(genome_metadata_clean)\n```\n\n### 3.3 Saving the data\n\nSaving the cleaned data into 02_dat_clean.tsv file located in the data directory.\n\n```{r}\nreadr::write_tsv(\n  x    = genome_metadata_clean,\n  file = \"../data/02_dat_clean.tsv\"\n)\n```\n","srcMarkdownNoYaml":"\n\n# Clean Data\n\n## 1. Load libraries\n\n```{r}\n#| message: false\n#| warning: false\nlibrary(\"tidyverse\")\n```\n\n## 2. Load data\n\nLoading the data saved in the 01_dat_load.tsv file\n\n```{r}\ngenome_metadata <- readr::read_tsv(\"../data/01_dat_load.tsv\")\n```\n\n## 3. Data preparation\n\nUsing the `str` command to investigate, what the data looks like:\n\n```{r}\nstr(genome_metadata)\n```\n\nThe data consist of a data-frame with 618 observations and 20 variables. We recognize that observations with no value found has the identifier \"not provided\". Additionally one variable contains phylogenetic information that can be split into different variable containing information about the different classes of the evolutionary history.\n\n### 3.1 Split data\n\nWe want to split the data in the \"lineage\" variable into multiple variables to store the information about each of the phylogenetic classes individually. First we investigate the data in the lineage variable:\n\n```{r}\ngenome_metadata |>\n  dplyr::select(Lineage) |>\n  dplyr::slice_sample(n = 10)\n```\n\nBy investigating the data it is seen that each string of phylogenetic information consist of identifiers for each of the different classes in the taxonomic rank. These identifiers are:\n\n-   d = domain\n\n-   p = phylum\n\n-   c = class\n\n-   o = order\n\n-   f = family\n\n-   g = genus\n\n-   s = species\n\nWe want to start with converting all \"not provided\" to NA across all character columns. Then we want to split the \"lineage\" variable into its seven taxonomic ranks to store the information about each of the phylogenetic classes individually. Then we want to extract each taxonomic rank and remove prefixes. And convert empty strings to NA in the new taxonomy columns.\n\nWe then remove the GTDB suffixes (e.g. \"\\_A\") to streamline taxonomies. Lastly we remove columns that will not be used in our analysis.\n\n```{r}\ngenome_metadata_clean <- genome_metadata |>\n  dplyr::mutate(\n    dplyr::across(\n      .cols = where(is.character),\n      .fns  = ~ dplyr::na_if(.x, \"not provided\")\n    )\n  ) |>\n  dplyr::mutate(\n    split_lineage = stringr::str_split_fixed(Lineage, \";\", 7),\n\n    Domain  = stringr::str_remove(split_lineage[, 1], \"d__\"),\n    Phylum  = stringr::str_remove(split_lineage[, 2], \"p__\"),\n    Class   = stringr::str_remove(split_lineage[, 3], \"c__\"),\n    Order   = stringr::str_remove(split_lineage[, 4], \"o__\"),\n    Family  = stringr::str_remove(split_lineage[, 5], \"f__\"),\n    Genus   = stringr::str_remove(split_lineage[, 6], \"g__\"),\n    Species = stringr::str_remove(split_lineage[, 7], \"s__\")\n  ) |>\n  dplyr::mutate(\n    dplyr::across(\n      .cols = c(Domain, Phylum, Class, Order, Family, Genus, Species),\n      .fns  = ~ dplyr::na_if(.x, \"\")\n    )\n  ) |>\n  dplyr::mutate(\n    dplyr::across(\n      .cols = Phylum:Species,\n      .fns  = ~ stringr::str_remove_all(as.character(.x), \"_[A-Za-z0-9]+\")\n    )\n  ) |>\n  dplyr::select(\n    -split_lineage,\n    -Genome_accession,\n    -Species_rep,\n    -Lineage,\n    -Sample_accession,\n    -Study_accession,\n    -FTP_download\n  )\n```\n\n### 3.2 Viewing the data\n\nViewing the top 10 rows of the split data to see the new structure.\n\n```{r}\ngenome_metadata_clean |> \n  dplyr::select(Genome, Domain:Species) |> \n  dplyr::slice_head(n = 10)\n```\n\n```{r}\nview(genome_metadata_clean)\n```\n\n### 3.3 Saving the data\n\nSaving the cleaned data into 02_dat_clean.tsv file located in the data directory.\n\n```{r}\nreadr::write_tsv(\n  x    = genome_metadata_clean,\n  file = \"../data/02_dat_clean.tsv\"\n)\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"0":"R/01_load.qmd","1":"R/02_clean.qmd","2":"R/03_augment.qmd","3":"R/04_describe.qmd","keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"02_clean.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","formats":{"html":{"embed-resources":false}},"title":"Clean dataset"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}