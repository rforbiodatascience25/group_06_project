{"title":"05_analysis_1","markdown":{"yaml":{"title":"05_analysis_1","format":"html"},"headingText":"Analysis 1 - Phylogenetic tree","containsRefs":false,"markdown":"\n\n\nThe dataset contains information the different phylogenetic classes, which can be used to plot the phylogenetic tree.\n\n## 1. Load libraries\n\n```{r}\n#| message: false\n#| warning: false\nlibrary(\"tidyverse\")\nlibrary(\"ggtree\")\nlibrary(\"ape\")\n```\n\n## 2. Load data\n\nLoading the data into a variable from the `03_dat_aug.tsv` file\n\n```{r}\n#| echo: false\n#| eval: true\ngenome_metadata_aug<- readr::read_tsv(file = \"../data/03_dat_aug.tsv\")\n```\n\n## 3. Prepare data for plot\n\nFirst the different ranks in the phylogenetic are defined:\n\n```{r}\nranks <- c(\"Domain\", \"Phylum\", \"Class\", \"Order\", \"Family\", \"Genus\", \"Species\")\n```\n\nThen the observations containing NA values in all the variables related to the phylogenetic taxonomy ranks. The `drop_na` command is used, but it is specified which columns it should remove NA values from. If it was not specifed, then all NA observations would be removed and then observations having NA values in different variables would have been lost.\n\n```{r}\ngenome_phylo_data <- genome_metadata_aug |>\n    tidyr::drop_na(all_of(ranks))\n```\n\nThe data needs to be changed into factors as it is required for the .phylo command.\n\n```{r}\ntax <- genome_phylo_data|>\n  dplyr::select(all_of(ranks)) |>         \n  dplyr::distinct() |>\n  dplyr::mutate(dplyr::across(everything(), as.factor))\n```\n\nUsing the as.phylo functions to translate the data into a tree. The hierachy of the data is defined in the function:\n\n```{r}\ntree <- ape::as.phylo(~ Domain/Phylum/Class/Order/Family/Genus/Species, data = tax)\n```\n\n## 4. Plot of phylogenetic tree\n\nThen the specific tips of the tree of interest is defined to be able to color the tree by phylum:\n\n```{r}\ntax_tip <- tax |>\n  dplyr::select(Species, Phylum) |>\n  dplyr::distinct() |>\n  dplyr::rename(label = Species)\n```\n\nThen the tip labels (the species) added to a list for each phylum:\n\n```{r}\nphylum_list <- split(tax_tip$label, tax_tip$Phylum)\n```\n\nThen the information about each of the phylum groups are added to the tree using the groupOTU command:\n\n```{r}\ntree_grp <- ggtree::groupOTU(.data = tree, .node = phylum_list)\n```\n\nTo plot the phylogenetic tree, the base plot is made:\n\n```{r}\np <- ggtree::ggtree(\ntr = tree_grp,\nlayout = \"circular\",\naes(color = factor(group)),\nsize = 0.4\n)\n```\n\nTo add the tax tips to the plot, the species and phylum is joined onto the tree data:\n\n```{r}\np$data <- p$data |>\n  dplyr::left_join(tax_tip, by = \"label\")\n```\n\nThe phylogenetic tree is then plotted and the edges of the plot is colored by the different phyla, to see the representation of the gene phyla present.\n\n```{r, fig.width=9.5, fig.height=9.5}\nphylogenetic_tree_plot <- p +\n  ggtree::geom_tiplab(\n    aes(label = label),\n    size = 1.5,\n    offset = 0.05,\n    align = TRUE) +\n  ggplot2::scale_color_discrete(\n    name = \"Phylum\",\n    labels = names(phylum_list)) +\n  ggplot2::labs(\n    title = \"Phylogenetic tree colored by phylum\",\n    caption = \"Note: NA values were removed before constructing the tree\") +\n  ggtree::theme_tree() +\n  ggplot2::theme(\n    plot.title = ggplot2::element_text(hjust = 0.5, face = \"bold\"),\n    plot.caption = ggplot2::element_text(hjust = 0.5, size = 6, color = \"grey40\"),\n    legend.title = ggplot2::element_text(face = \"bold\"))\n\nphylogenetic_tree_plot\n```\n\n```{r}\n#| echo: false\n#| eval: false\nggplot2::ggsave(\n  \"../results/05_key_plot_1.png\",\n  phylogenetic_tree_plot,\n  width = 10,\n  height = 10,\n  dpi = 300)\n```\n","srcMarkdownNoYaml":"\n\n# Analysis 1 - Phylogenetic tree\n\nThe dataset contains information the different phylogenetic classes, which can be used to plot the phylogenetic tree.\n\n## 1. Load libraries\n\n```{r}\n#| message: false\n#| warning: false\nlibrary(\"tidyverse\")\nlibrary(\"ggtree\")\nlibrary(\"ape\")\n```\n\n## 2. Load data\n\nLoading the data into a variable from the `03_dat_aug.tsv` file\n\n```{r}\n#| echo: false\n#| eval: true\ngenome_metadata_aug<- readr::read_tsv(file = \"../data/03_dat_aug.tsv\")\n```\n\n## 3. Prepare data for plot\n\nFirst the different ranks in the phylogenetic are defined:\n\n```{r}\nranks <- c(\"Domain\", \"Phylum\", \"Class\", \"Order\", \"Family\", \"Genus\", \"Species\")\n```\n\nThen the observations containing NA values in all the variables related to the phylogenetic taxonomy ranks. The `drop_na` command is used, but it is specified which columns it should remove NA values from. If it was not specifed, then all NA observations would be removed and then observations having NA values in different variables would have been lost.\n\n```{r}\ngenome_phylo_data <- genome_metadata_aug |>\n    tidyr::drop_na(all_of(ranks))\n```\n\nThe data needs to be changed into factors as it is required for the .phylo command.\n\n```{r}\ntax <- genome_phylo_data|>\n  dplyr::select(all_of(ranks)) |>         \n  dplyr::distinct() |>\n  dplyr::mutate(dplyr::across(everything(), as.factor))\n```\n\nUsing the as.phylo functions to translate the data into a tree. The hierachy of the data is defined in the function:\n\n```{r}\ntree <- ape::as.phylo(~ Domain/Phylum/Class/Order/Family/Genus/Species, data = tax)\n```\n\n## 4. Plot of phylogenetic tree\n\nThen the specific tips of the tree of interest is defined to be able to color the tree by phylum:\n\n```{r}\ntax_tip <- tax |>\n  dplyr::select(Species, Phylum) |>\n  dplyr::distinct() |>\n  dplyr::rename(label = Species)\n```\n\nThen the tip labels (the species) added to a list for each phylum:\n\n```{r}\nphylum_list <- split(tax_tip$label, tax_tip$Phylum)\n```\n\nThen the information about each of the phylum groups are added to the tree using the groupOTU command:\n\n```{r}\ntree_grp <- ggtree::groupOTU(.data = tree, .node = phylum_list)\n```\n\nTo plot the phylogenetic tree, the base plot is made:\n\n```{r}\np <- ggtree::ggtree(\ntr = tree_grp,\nlayout = \"circular\",\naes(color = factor(group)),\nsize = 0.4\n)\n```\n\nTo add the tax tips to the plot, the species and phylum is joined onto the tree data:\n\n```{r}\np$data <- p$data |>\n  dplyr::left_join(tax_tip, by = \"label\")\n```\n\nThe phylogenetic tree is then plotted and the edges of the plot is colored by the different phyla, to see the representation of the gene phyla present.\n\n```{r, fig.width=9.5, fig.height=9.5}\nphylogenetic_tree_plot <- p +\n  ggtree::geom_tiplab(\n    aes(label = label),\n    size = 1.5,\n    offset = 0.05,\n    align = TRUE) +\n  ggplot2::scale_color_discrete(\n    name = \"Phylum\",\n    labels = names(phylum_list)) +\n  ggplot2::labs(\n    title = \"Phylogenetic tree colored by phylum\",\n    caption = \"Note: NA values were removed before constructing the tree\") +\n  ggtree::theme_tree() +\n  ggplot2::theme(\n    plot.title = ggplot2::element_text(hjust = 0.5, face = \"bold\"),\n    plot.caption = ggplot2::element_text(hjust = 0.5, size = 6, color = \"grey40\"),\n    legend.title = ggplot2::element_text(face = \"bold\"))\n\nphylogenetic_tree_plot\n```\n\n```{r}\n#| echo: false\n#| eval: false\nggplot2::ggsave(\n  \"../results/05_key_plot_1.png\",\n  phylogenetic_tree_plot,\n  width = 10,\n  height = 10,\n  dpi = 300)\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"0":"R/01_load.qmd","1":"R/02_clean.qmd","2":"R/03_augment.qmd","3":"R/04_describe.qmd","keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"05_analysis_1.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","formats":{"html":{"embed-resources":false}},"title":"05_analysis_1"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}