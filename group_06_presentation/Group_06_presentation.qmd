---
title: "Exploring meta-data of human vaginal microbiome"
subtitle: "Group 6"
author:
  - Alberte Englund
  - Mathilde Due
  - Line Winther Gormsen
  - Sigrid Frandsen
  - Kristine Johansen
  
format: 
  revealjs:
    theme: moon
    self-contained: true
    code-line-numbers: true
    smaller: true
    scroll: true
    transition: slide
editor: visual
---

```{r}
library("tidyverse")
library("readr")
library("broom")
library("here")
library("ggrepel")
```

## STUDY DESCRIPTION

Meta-data from MGnify’s vaginal microbiome genome catalogue

-   Uncover patterns in genome quality, taxonomic composition, and ecological characteristics.

-   Identify potential patterns for diagnosis of endometriosis via associated pathogens of the vaginal microbiota based on genus:

    -   *Anaerococcus, Ureaplasma, Gardnerella, Veillonella, Corynebacterium, Peptoniphilus, Candida albicans, Alloscardovia* [^1]

[^1]: MacSharry, J., Kovács, Z., Xie, Y. *et al.* Endometriosis specific vaginal microbiota links to urine and serum *N*-glycome. *Sci Rep* **14**, 25372 (2024). https://doi.org/10.1038/s41598-024-76125-2

## DATA CLEANING AND WRANGLING {.scrollable}

:::: {style="margin-top: -15px; margin-bottom: -15px;"}
**Untidy –\> tidy data**

::: {style="margin-left: 1.5em; font-size: 0.8em; line-height: 1.1;"}
::: incremental
1.  *Split the data in the "lineage" variable into multiple variables of seven taxonomic ranks.*
2.  *Extract and mutate prefixes and GTDB suffixes (e.g. "\_A") to streamline taxonomies*
2.  *Each variable occupies a column, and each observation occupies a row.*
3.  *Mutate all "not provided" and empty strings to NA.*
4.  *Remove columns that will not be used in our analysis.*
5.  *Quality of the MAGs - completeness, contamination, and genome quality (high, medium, low) - joined to the left side of tidy data.*
6.  *Add column to MAGs dataset that flags each endometriosis-associated genus (True/False)*

:::
:::
::::

::: panel-tabset
### Untidy datafile

```{r}
#| echo: true  
print(readr::read_tsv(here("data/_raw/genomes-all_metadata.tsv")))
```

### Lineages
```{r}
#| echo: true
untidy_data <- readr::read_tsv(
  here::here("data/_raw/genomes-all_metadata.tsv"))
  print(
    untidy_data  |>
    dplyr::select(Lineage))
```

### Tidy data

```{r}
#| echo: true   
print(readr::read_tsv(here("data/02_dat_clean.tsv")))
```
### Taxonomic ranks 
```{r}
#| echo: true
tidy_data <- readr::read_tsv(
  here::here("data/02_dat_clean.tsv"))
  print(
    tidy_data  |>
    dplyr::select(Domain, Phylum, Class, Order, Family, Genus, Species))
```

### Augmentation

```{r}
#| echo: true
options(width = 200)
Aug_data <- readr::read_tsv(
  here::here("data/03_dat_aug.tsv"))
  print(
    Aug_data  |>
    dplyr::select(Completeness_quality, Contamination_quality, Overall_quality, endometriosis_associated),
    width = Inf)

```
:::

## DATA DESCRIPTION {.scrollable}

::: incremental
-   618 vaginal metagenome-assembled genomes (MAGs)
-   25 variables covering taxonomy, assembly quality, and geography
-   High completeness and low contamination for most genomes
-   Dataset dominated by a few major bacterial phyla
-   Genome lengths fall within biologically expected ranges
:::

. . .

::: panel-tabset
## Phylum distribution

Most MAGs belong to only a few dominant phyla.\
This indicates strong taxonomic skew in the dataset.

![](../results/desc_phylum_barplot.png){width="70%"}

------------------------------------------------------------------------

## Completeness distribution

Most genomes have high completeness (\>90%),\
indicating generally strong assembly quality.

![](../results/desc_completeness_hist.png){width="70%"}

------------------------------------------------------------------------

## Genome length distribution

Genome lengths fall within the expected biological range\
for vaginal bacterial taxa (typically 1.5–3 Mb).

![](../results/desc_length_hist.png){width="70%"}
:::

## ANALYSIS 1

## ANALYSIS 2

## ANALYSIS 3 - Associated and non-associated-endometriosis MAGs {.scrollable}

::: incremental
-   Compared endometriosis-associated vs non-associated MAGs
-   Focused on GC content, genome length, completeness & contamination
-   Investigated whether associated MAGs cluster taxonomically
-   Goal: determine if associated MAGs form a genomically distinct group
:::

. . .

::: panel-tabset
## Phylum distribution

Endometriosis-associated MAGs occur in only a few phyla.\
Most phyla contain *no* associated MAGs, suggesting limited taxonomic clustering.

![](../results/analysis3_phylum_proportion.png){width="80%"}

------------------------------------------------------------------------

## GC content

GC content ranges overlap almost completely.\
No evidence that GC% distinguishes associated vs non-associated MAGs.

![](../results/analysis3_gc_violin.png){width="80%"}
:::

## ANALYSIS 4 - Species Distribution between countries {.scrollable}

::: incremental
-   Investigating the distribution of lineage groups in Countries
-   Counted group instances for each country and wide format
-   Filtered for NA in Countries
-   Big difference in sample size --\> normalize
:::

. . .

::: panel-tabset
## Heatmap

Some variation between countries. I.e. Order Bacteroidales, but not much.

Could've tested for significance.

![](../results/Heatmap_family.png){width="87%"} ![](../results/Heatmap_order.png){width="87%"} ![](../results/Heatmap_phylum.png){width="87%"}

## Principal Component Analysis (PCA)

Only two principal components --\> 100% variance.

![](../results/PCA_variance_explained.png){width="60%"}

Clear division of countries.

Along PC1, Fusobacteria and Bacteroidota (order = Bacteroidales). Correlation with heatmap.

![](../results/PCA_biplot.png){width="100%"}
:::

## DISCUSSION & FUTURE PERSPECTIVES

-   High-quality MAGs with good completeness\
-   No strong genomic differences between groups\
-   Limited metadata and uneven sampling
-   Improve clinical + geographic metadata


## CONCLUSION
